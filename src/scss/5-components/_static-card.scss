/* ============================================================
   5-COMPONENTS / _STATIC-CARD.SCSS
   Batura Library | Bottom Anchor v32.1 [Gravity Sync]
   ============================================================ */

.b-static-card {
  /* 1. ГЕОМЕТРИЯ И МАТЕРИАЛ */
  --s-card-radius: var(--radius-master);
  --_preview-radius: calc(var(--s-card-radius) - (var(--p-card) * 0.5));

  @include glass-surface(var(--s-card-radius));
  
  width: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
  
  /* ИЗМЕНЕНИЕ: height: 100% позволяет карточке растягиваться 
     под высоту самой длинной карточки в ряду. */
  height: 100%; 

  /* 2. СОСТОЯНИЯ (БЕЗ ИЗМЕНЕНИЙ) */
  --_bg-op: var(--s-glass-op-base);
  --_stroke-op: var(--s-stroke-op-idle);
  --_text-op: var(--s-text-op-idle);

  &.is-focused, &:hover { transition-delay: 0s; }
  
  &.is-focused { 
    --_stroke-op: var(--s-stroke-op-hover); 
    --_text-op: var(--_text-op-hover, var(--s-text-op-hover)); 
    --_bg-op: var(--s-glass-op-hover);
  }

  &:hover {
    --_bg-op: var(--s-glass-op-hover);
    --_stroke-op: var(--s-stroke-op-active);
    --_glare-op: var(--s-glare-op-hover);
    --_text-op: 1;
  }

  /* 3. ВЬЮПОРТ (Внутренняя гравитация) */
  &__viewport {
    padding: var(--p-card);
    @include flow-engine(var(--space-md)); 
    display: flex;
    flex-direction: column;
    flex: 1; 
    border-radius: inherit; 
    position: relative;
    
    /* ИЗМЕНЕНИЕ: Убираем overflow, если это возможно. 
       Если внутри есть картинки, которые надо резать — 
       лучше дать border-radius самим картинкам. */
    overflow: visible; 
  }


  &__top { 
    display: flex; 
    justify-content: space-between; 
    align-items: baseline; 
    width: 100%; 
  }

  &__index { 
    @extend .text-data; 
    font-weight: 400; 
  }

  /* 4. ТЕКСТОВЫЙ БЛОК (БЕЗ ИЗМЕНЕНИЙ) */
  &__body {
    flex: none; 
    display: flex;
    flex-direction: column;
    align-items: flex-start;

    & > .text-heading + .text-body { 
      margin-top: var(--space-xs); 
    }
    
    & > .text-body + .b-static-card__tags {
      margin-top: var(--space-xs);
    }
  }

  /* 5. КНОПКА (Гравитация вкл.) */
  &__actions { 
    display: flex; 
    justify-content: flex-start; 
    width: 100%; 
    
    /* ИЗМЕНЕНИЕ: margin-top: auto выталкивает блок вниз.
       var(--space-sm) остается как минимальный отступ, если текста много. */
    margin-top: auto; 
    padding-top: var(--space-sm); 
  }

  &__tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-sm);
  }

  /* 6. ПРЕВЬЮ И АДАПТИВ (БЕЗ ИЗМЕНЕНИЙ) */
  .b-preview-box {
    --local-preview-radius: var(--_preview-radius);
    width: 100%;
    aspect-ratio: 16/9;
    @include glass-surface(var(--local-preview-radius));
    overflow: hidden;
  }

  @media (max-width: 768px) {
    &.is-focused {
      --_bg-op: var(--s-glass-op-hover);
      --_stroke-op: var(--s-stroke-op-active);
      --_text-op: 1;

      .ui-button {
        --_bg-op: var(--s-glass-op-active);
        --_stroke-op: var(--s-stroke-op-active);
        --_text-op: 1;
        transition-delay: 0s;
      }
    }
  }
}