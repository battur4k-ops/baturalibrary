@keyframes cardItemEntrance {
  0% { opacity: var(--opacity-hidden); transform: translate3d(var(--entrance-offset), 0, var(--opt-z-fix)); }
  100% { opacity: var(--opacity-visible); transform: translate3d(0, 0, var(--opt-z-fix)); }
}

.b-accordion {
  display: flex;
  width: 100%;
  gap: var(--space-sm);
  height: clamp(var(--accordion-height-min), 70vh, var(--accordion-height-max));
  flex-direction: row;

  .b-static-card {
    position: relative;
    overflow: hidden;
    cursor: pointer;
    flex: var(--card-grow-base) 0 10%;
    min-width: var(--accordion-tab-min);
    
    --s-card-radius: var(--radius-master);
    @include glass-panel(var(--s-card-radius));

    transition: flex var(--d-slow) var(--e-out), 
                background-color var(--d-fast) var(--e-out), 
                box-shadow var(--d-fast) var(--e-out);

    &__index {
      @extend .text-data;
      position: absolute; top: var(--p-card); left: var(--p-card);
      z-index: 10;
      color: rgba(var(--p-white-rgb), var(--s-text-op-idle));
      transition: color var(--d-fast) var(--e-out);
    }

    &__deco {
      @extend .text-data;
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%) rotate(-180deg);
      writing-mode: vertical-rl; white-space: nowrap; pointer-events: none;
      z-index: 5;
      color: rgba(var(--p-white-rgb), var(--s-text-op-idle));
      transition: opacity var(--d-fast) var(--e-out), visibility var(--d-fast) var(--e-out);
    }

    &:hover, &.is-active {
        .b-static-card__index { color: rgba(var(--p-white-rgb), var(--s-text-op-hover)); }
        .b-static-card__deco {
            opacity: var(--opacity-hidden); visibility: hidden;
            transition-property: none; transition-duration: 0s;
        }
    }

    &__viewport {
      height: 100%; padding: var(--p-card);
      display: flex; flex-direction: column; justify-content: flex-end; 
      opacity: var(--opacity-hidden); visibility: hidden; z-index: 7;
      flex: none; 
    }

    &.is-active {
      flex: var(--card-grow-active) 0 10%;
      cursor: default;
      --_stroke-op: var(--s-stroke-op-hover);

      .b-static-card__viewport {
        opacity: var(--opacity-visible); visibility: visible;
        & > * {
          animation: cardItemEntrance var(--d-base) var(--e-out) both;
          &:nth-child(1) { animation-delay: calc(var(--entrance-delay) + 0.1s); }
          &:nth-child(2) { animation-delay: calc(var(--entrance-delay) + 0.2s); }
        }
      }

      .b-static-card__body {
        flex: none; 
        margin-bottom: 0; 
        
        h3, p { margin: 0; }
        
        .text-data { 
          display: block; 
          margin-bottom: var(--space-xs); 
          opacity: var(--s-text-op-hover); 
        }

        .text-heading { margin-left: var(--text-offset-heading); }
        .text-heading + .text-body { margin-top: var(--space-xs); }
      }

      .b-static-card__actions {
        margin-top: var(--space-sm);
        display: flex;
      }

      &:hover {
        flex: var(--card-grow-active-hover) 0 10%;
        --_bg-op: var(--s-glass-op-hover);
        --_stroke-op: var(--s-stroke-op-active);
      }
    }

    &:not(.is-active):hover {
      flex: calc(var(--card-grow-base) * 1.4) 0 10%;
      --_bg-op: var(--s-glass-op-hover);
    }
  }

  @media (max-width: $bp-md) {
    flex-direction: column;
    height: clamp(var(--accordion-height-min-mobile), 80vh, var(--accordion-height-max-mobile));

    .b-static-card {
      min-width: 100%;
      min-height: var(--accordion-tab-min-mobile); 
      flex: var(--card-grow-base) 0 var(--accordion-tab-min-mobile);
      border-radius: var(--accordion-tab-radius); 

      &:not(.is-active):hover { flex: var(--card-grow-base) 0 var(--accordion-tab-min-mobile); }

      &__index { top: 50%; transform: translateY(-50%); }
      &__deco {
        writing-mode: horizontal-tb; top: 50%; left: 50%;
        transform: translate(-50%, -50%); opacity: var(--opacity-visible);
      }

      &.is-active {
        flex: var(--accordion-flex-mobile-active) 0 10%; 
        border-radius: var(--s-card-radius);

        --_stroke-op: var(--s-stroke-op-active); 
        --_text-op: 1;

        .b-static-card__index { top: var(--p-card); transform: translateY(0); }

        .b-static-card__viewport {
          & > * {
            animation-name: cardItemEntranceMobile;
          }
        }

        .ui-button {
          --_bg-op: var(--s-glass-op-active);
          --_stroke-op: var(--s-stroke-op-active);
          --_text-op: 1;
          transition-delay: 0s;
          &:active { transform: scale(var(--scale-press-strong)); }
        }

        &:hover { flex: var(--accordion-flex-mobile-active) 0 10%; }
      }
    }
  }
}